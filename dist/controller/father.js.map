{"version":3,"sources":["../../src/controller/father.js"],"names":["config","db","api","post","req","res","newFather","Father","name","body","age","position","coordinates","save","err","send","json","message","get","find","fathers","findById","params","id","father","put","delete","deleteOne","_id","newSon","Son","son","sons","push"],"mappings":"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","file":"father.js","sourcesContent":["import mongoose from 'mongoose';\r\nimport { Router } from 'express';\r\nimport Father from '../model/father';\r\nimport Son from '../model/son';\r\n\r\nimport { authenticate } from '../middleware/authMiddleware';\r\n\r\nexport default({ config, db}) => {\r\n  let api = Router();\r\n\r\n  //CRUD - Create Read Update Delete Operations\r\n\r\n  // '/v1/father/add' -Create\r\n  api.post('/add', (req, res) => {\r\n    let newFather = new Father();\r\n    newFather.name = req.body.name;\r\n    newFather.age = req.body.age;\r\n    newFather.position.coordinates = req.body.position.coordinates;\r\n\r\n    newFather.save(err => {\r\n      if(err) {\r\n        res.send(err);\r\n      }\r\n      res.json({ message: 'Father saved successfully' });\r\n    });\r\n  });\r\n\r\n  // '/v1/father' - Read\r\n  api.get('/' , (req, res) => {\r\n    Father.find({}, (err, fathers) => {\r\n      if (err) {\r\n        res.send(err);\r\n      }\r\n      res.json(fathers)\r\n    });\r\n  });\r\n\r\n  // 'v1/father/:id' - Read 1\r\n  api.get('/:id', (req, res) => {\r\n    Father.findById(req.params.id, (err, father) => {\r\n      if(err) {\r\n        res.send(err);\r\n      }\r\n      res.json(father);\r\n    });\r\n  });\r\n\r\n\r\n  //'v1/father/:id' -Update\r\n  api.put('/:id', (req, res) => {\r\n    Father.findById(req.params.id, (err, father) =>{\r\n      if (err) {\r\n        res.send(err);\r\n      }\r\n      father.name = req.body.name;\r\n      father.save( err => {\r\n        if(err) {\r\n          res.send(err);\r\n        }\r\n        res.json({ message: \"Father info updated\" });\r\n      });\r\n    });\r\n  });\r\n\r\n  //'v1/father/:id' -- Delete\r\n  api.delete('/:id', (req, res) => {\r\n    Father.deleteOne({\r\n      _id: req.params.id\r\n    }, (err, father) => {\r\n      if (err) {\r\n        res.send(err);\r\n      }\r\n      res.json({ message: \"Father successfully Removed!\"});\r\n    });\r\n  });\r\n\r\n  //add son for a specifc father id\r\n  // '/v1/father/sons/add/:id'\r\n  api.post('/sons/add/:id', (req, res) => {\r\n    Father.findById(req.params.id, (err, father) => {\r\n      if(err) {\r\n        res.send(err);\r\n      }\r\n\r\n      let newSon = new Son();\r\n      newSon.name = req.body.name;\r\n      newSon.father = father._id;\r\n\r\n      newSon.save((err, son) => {\r\n        if(err) {\r\n          res.send(err);\r\n        }\r\n      father.sons.push(newSon);\r\n      father.save((err, father) => {\r\n        if(err) {\r\n          res.send(err);\r\n        }\r\n        res.json({ message: 'Son is created and related with a father saved!'});\r\n      });\r\n    });\r\n  });\r\n});\r\n\r\n\r\n\r\n  return api;\r\n}\r\n"]}